{"title":"Age Adjusted Rates in Epidemiology","markdown":{"yaml":{"title":"Age Adjusted Rates in Epidemiology","author":"Raju Rimal","date":"2022-12-02T21:00:57+01:00","draft":false,"tags":["Statistics","Epidemiology"]},"headingText":"Age-specific rate","containsRefs":false,"markdown":"\n\n```{r, include=FALSE}\nautoload(\"%>%\", \"magrittr\")\nlibrary(data.table)\nlibrary(ggplot2)\n```\n\nIn general, rates means how fast something is changing usually over time. In\nepidemiology uses it to describe how quickly a disese occurs in a population.\nFor example, 35 cases of melanoma cases in 100,000 person per year convey a the\nsense of speed of spread of disease in that population. Incidence rate and \nmortality rate are two examples that we will discuss further below.\n\n> In epidemiology, rate measures the frequency of occurance of an event in a \n> given population over certain period of time[^1].\n\nLet us use melanoma as a outcome in the following discussion. Here, we can \ncalculate a crude incidence rate as,\n\n$$\\mathcal{R} = \\frac{\\textsf{no. of melanoma cases}}{\\textsf{no. of person-year}} \\times \\textsf{some multiplier}$$\n\nIn the case of mortality rate, we can replace the numerator of above expression\nby the number of melanoma deaths.\n\n\nWeather to understand a broder prespecitve or to compare across population, these\nrates are often analyzed stratified by sex and age. This also helps to remove \nthe confounding effection of these factors. The incidence/mortality rate\nper age-group is usually referred to as _Age-specific rates_ where rates\nare computed for each age-groups. This is often desirable since factor `age` \nhas a strong effect on mortality and incidence of most disease especially the \ncronic one.\n\n## Age-adjusted rate\n\nMany research articles, however presents the age-adjusted rates. Age-adjusted \nrates are standardized (weighted) using some standard population age-structure. \nFor example, many european studies on melanoma uses european standard age\ndistribution. While any reasonal studies have also used world standard population.\nCancer registry in their reports sometimes uses age-structure of that country in\nsome given year. For instance, Norway[^3] and Finland[^4] have used the their population in \n2014 as standard population in their recent cancer report while Australia have\nused 2001 Australian population[^5].\n\nStandardized (adjusted) rates makes comparison between the population possible.\nFigure \\@ref(fig:age-std) shows the difference in the age distribution between\nworld population and European population. Following table are some of the\nstandard population often used in the study. Further on standard popuation see \n[`seer.cancer.gov`](https://seer.cancer.gov/stdpopulations/stdpop.19ages.html)[^6].\n\n:::: columns\n::: column\n\n```{r, echo=FALSE}\nstd_pop <- copy(popEpi::stdpop18)\nstd_pop[agegroup == \"85\", agegroup := \"85+\"]\nsetnames(std_pop, c(\"Age Group\", \"World\", \"Europe\", \"Nordic\"))\nkableExtra::kbl(std_pop, caption = \"European and World standard population\") %>%\n    kableExtra::kable_styling(full_width = FALSE) %>%\n    kableExtra::row_spec(1:nrow(std_pop), extra_css = \"padding: 2px;\")\n```\n:::\n::: column\n\n```{r, echo=FALSE}\nus2000 <- data.table(\n`Age Group` = c(\n    \"00\", \"01-04\", \"05-09\", \"10-14\", \"15-19\", \n    \"20-24\", \"25-29\", \"30-34\", \"35-39\", \"40-44\", \"45-49\", \"50-54\",\n    \"55-59\", \"60-64\", \"65-69\", \"70-74\", \"75-79\", \"80-84\", \"85+\"), \nStd.Population = c(\n    13818, 55317, 72533, 73032, 72169, 66478, 64529, 71044, 80762, 81851, \n    72118, 62716, 48454, 38793, 34264, 31773, 26999, 17842, 15508)\n)\nus2000 %>% \n    kableExtra::kbl(caption = \"US 2000 standard population\") %>%\n    kableExtra::kable_styling(full_width = FALSE) %>%\n    kableExtra::row_spec(1:nrow(us2000), extra_css = \"padding: 1px;\")\n```\n\n:::\n::::\n\n:::: columns\n::: column\n## Calculating age-standardized rate\n\nThe age-standardized rate (ASR) is calculated as,\n\n$$\\text{Age.Std. Rate} = \\frac{\\sum_i\\mathcal{R}_i\\mathcal{w}_i}{\\sum_i\\mathcal{w}_i}$$\n\nwhere, $\\mathcal{w}_i$ is the weight corresponding to $i^\\text{th}$ age-group in the \nreference population.\n\nLet's explore further with an example from melanoma cases from Australia.\n\n:::\n::: column\n```{r, include=FALSE}\ndata(stdpop18, package = \"popEpi\")\npop_data <- copy(stdpop18)\npop_data[, nordic := NULL]\npop_data[, id := .I]\n\npop_plot <- melt.data.table(\n  pop_data,\n  id.vars = c(\"agegroup\", \"id\")\n)[variable == \"world\", value := value * -1][order(id)] %>% \n  ggplot(aes(value, reorder(agegroup, id), fill = variable)) +\n  geom_col(width = 1, color = \"#f0f0f0\", size = 0.2) +\n  theme_minimal() +\n  ggthemes::scale_fill_economist(\n    labels = stringr::str_to_title\n  ) +\n  theme(\n    legend.position = \"none\",\n    panel.grid.major.y = element_blank(),\n    panel.grid.minor.y = element_line(color = \"red\")\n  ) +\n  scale_x_continuous(\n    labels = abs,\n    expand = expansion()\n  ) +\n  scale_y_discrete(\n    expand = expansion()\n  ) +\n  labs(\n    x = \"Number of person\",\n    y = NULL,\n    fill = \"Population\"\n  ) +\n  annotate(\n    geom = \"text\",\n    x = -Inf,\n    y = Inf,\n    label = \"World\",\n    hjust = -0.5,\n    vjust = 1.5\n  ) +\n  annotate(\n    geom = \"text\",\n    x = Inf,\n    y = Inf,\n    label = \"Europe\",\n    hjust = 1.5,\n    vjust = 1.5\n  )\n```\n\n```{r age-std, echo=FALSE, fig.width=4, out.width=\"100%\", dev=\"svg\", fig.asp = 0.8, fig.cap=\"World and European standard population\"}\npop_plot\n```\n:::\n::::\n\n## Example\n\nThe following example have used the Austrailian cancer data with 5-year \nage-group[^2] after filtering melanoma cases from 1982 to 2018. The dataset has\nyearly count and age-specific incidence rate of melanoma for men and women.\n\nLet us use the above European standard population to find the yearly\nage-standardized incidence by sex.\n\n```{r}\ndata <- fread(\"melanoma.csv\")\nstd_pop <- popEpi::stdpop18\n```\n```{r}\ndata[AgeGroup %in% c(\"85-89\", \"90+\"), AgeGroup := \"85+\"]\nsetnames(std_pop, c(\"AgeGroup\", \"World\", \"Europe\", \"Nordic\"))\nstd_pop[AgeGroup == \"85\", AgeGroup := \"85+\"]\nstd_pop[, c(2:4) := lapply(.SD, prop.table), .SDcols = 2:4]\nasp_data <- merge.data.table(data, std_pop[, .(AgeGroup, World)], by = \"AgeGroup\")\nasp <- asp_data[, .(AgeAdjRate = sum(ASR * World)), by = .(Year, Sex)]\n```\n```{r}\nasp[, tail(.SD, 8), by = Sex] %>%\n    dcast.data.table(\n        formula = Sex ~ Year,\n        value.var = \"AgeAdjRate\") %>% \n        kableExtra::kbl(caption = paste(\n            \"Age-standardized incidence rate of melanoma\",\n            \"Australia from 2011 to 2018\"\n    )) %>% \n    kableExtra::kable_styling(full_width = FALSE)\n```\n\nNow, let us compare the age-specific rates (crude rates) and  age-standardized\nrates with a plot,\n\n### Compare the age-specific rates and age-adjusted rates {.accordions}\n\n#### Plot {.accordion}\n```{r rate-plot, echo = FALSE, fig.asp = 0.5, fig.cap = \"Age-standardized melanoma rate in Australia\", dev = \"svg\"}\nggplot() +\n    geom_line(\n        data = data, \n        aes(\n            x = Year, \n            y = ASR, \n            group = AgeGroup,\n            color = \"Crude\"\n        )\n    ) +\n    geom_line(\n        data = asp,\n        aes(\n            x = Year, \n            y = AgeAdjRate, \n            group = 1,\n            color = \"Age-adjusted\"\n        )\n    ) +\n    geom_text(\n        data = data[Year == max(Year)],\n        check_overlap = TRUE,\n        size = rel(2),\n        color = \"#0f0f0f\",\n        aes(\n            x = Year + 2,\n            y = ASR,\n            label = AgeGroup\n        )\n    ) +\n    scale_x_continuous(breaks = scales::breaks_extended(8)) +\n    scale_y_continuous(breaks = scales::breaks_extended(8)) +\n    scale_color_manual(NULL, values = c(\"firebrick\", \"grey\")) +\n    facet_grid(cols = vars(Sex)) +\n    theme_minimal() +\n    theme(\n        panel.border = element_rect(fill = NA, color = \"darkgrey\"),\n        legend.position = c(0, 1),\n        legend.justification = c(0, 1)\n    ) +\n    labs(\n        x = \"Diagnosis year\",\n        y = paste(\n            \"Age-adjusted incidence rate\",\n            \"per 100,000 person year\",\n            sep = \"\\n\"\n        )\n    )\n```\n\n#### Code {.accordion}\n\n```{r rate-plot, echo = TRUE, eval = FALSE}\n```\n\n### Compare the age-adjusted rates by sex {.accordions}\n\n#### Plot {.accordion}\n```{r adj-rate-plot, echo=FALSE, fig.asp = 0.5, fig.cap = \"Age-standardized melanoma rate in Australia\", dev = \"svg\"}\nggplot(asp, aes(x = Year, y = AgeAdjRate, color = Sex)) +\n    geom_line() +\n    geom_point(fill = \"whitesmoke\", shape = 21) +\n    scale_x_continuous(breaks = scales::breaks_extended(8)) +\n    scale_y_continuous(breaks = scales::breaks_extended(8)) +\n    scale_color_brewer(palette = \"Set1\") +\n    theme_minimal() +\n    theme(\n        panel.border = element_rect(fill = NA, color = \"darkgrey\"),\n        legend.position = c(0, 1),\n        legend.justification = c(0, 1)\n    ) +\n    labs(\n        x = \"Diagnosis year\",\n        y = paste(\n            \"Age-adjusted incidence rate\",\n            \"per 100,000 person year\",\n            sep = \"\\n\"\n        )\n    ) +\n    expand_limits(y = 0)\n```\n\n#### Code {.accordion}\n\n```{r rate-plot, echo = TRUE, eval = FALSE}\n```\n\n## Discussion\n\nFigure \\@fig(rate-plot) shows that the incidence of melanoma has larger \ndifference in men between the age-groups than in women and men also have a sharp \nincrease in older age group. In addition, the Figure \\@fig(adj-rate-plot) shows that males have higher\nage-adjusted incidence of melanoma than women in Australia and this trend is \nincreasing over time with rapid increase before 1983 before a drop.\n\nAge-adjusted rates are useful for comparing rates between population but it\ncannot give the interpretation required for comparing within a population or\nover a time period in that population. This is one of the reason, cancer registry\nuses the internal (population structure of their own population) to compute the\nage-adjusted rates.\n\n\n[^1]: https://www.cdc.gov/csels/dsepd/ss1978/lesson3/section1.html\n[^2]: https://www.aihw.gov.au/reports/cancer/cancer-data-in-australia/data\n[^3]: https://www.kreftregisteret.no/globalassets/cancer-in-norway/2021/cin_report.pdf\n[^4]: https://cancerregistry.fi/reports-and-publications/annual-report-on-cancer-in-finland/\n[^5]: https://www.aihw.gov.au/reports/cancer/cancer-in-australia-2021/summary\n[^6]: https://seer.cancer.gov/stdpopulations/stdpop.19ages.html"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","filters":["lightbox"],"toc":true,"output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","fontsize":"1.2em","linestretch":1.75,"theme":{"light":["default","../../../light.scss","../../../styles.scss"],"dark":["default","../../../dark.scss","../../../styles.scss"]},"title-block-banner":false,"title":"Age Adjusted Rates in Epidemiology","author":"Raju Rimal","date":"2022-12-02T21:00:57+01:00","draft":false,"tags":["Statistics","Epidemiology"]},"extensions":{"book":{"multiFile":true}}}}}
{"title":"How ANOVA analyze the variance","markdown":{"yaml":{"title":"How ANOVA analyze the variance","slug":"how-anova-analyze-the-variance","author":"therimalaya","date":"2021-03-29","tags":["Statistics","ANOVA"]},"headingText":"Simulating data resembling these cases","containsRefs":false,"markdown":"\n\n```{r, include = FALSE}\nknitr::opts_chunk$set(\n  echo = FALSE,\n  comment = NA,\n  out.width = \"100%\",\n  dev = \"svg\"\n)\nlibrary(data.table)\nlibrary(purrr)\nlibrary(ggplot2)\n\nggplot2::theme_set(ggthemes::theme_few() + theme(\n  panel.grid = element_line(color = \"#f0f0f0\")\n))\n\nset.seed(124)\n```\n\n\nOften we Analysis of Variance (ANOVA) to analyze the variances to find if \ndifferent cases results in similar outcome and if the difference is significant. \nFollowing are some simple examples,\n\n- The effect of different diets on growth of fishes\n- Comparing the height of three different species of a plant\n- Type of flour used for baking a bread\n\nThese are some common examples where in some cases data are collected by setting \nup an experiment and in other cases they are collected through sampling. \nThis article tries to explain how the ANOVA analyze the variance and in what \nsituation are they significant throught both simulated and real data.\n\nConsider the following model with $i=3$ groups and $j=n$ observations,\n\n$$y_{ij} = \\mu + \\tau_i + \\varepsilon_{ij}, \\; i = 1, 2, 3 \n\\texttt{ and } j = 1, 2, \\ldots n$$\n\nhere, $\\tau_i$ is the effect corresponding to group $i$ and \n$\\varepsilon_{ij} \\sim \\mathrm{N}(0, \\sigma^2)$, the usual assumption of \nlinear model. In order to understand how ANOVA finds the differences between \ngroups and how the group mean and their standard deviation influence the\nresults from ANOVA, let us consider following four cases:\n\nCase 1\n: Similar group means with high variation within the groups\n\nCase 2\n: Similar group means with low variation within the groups\n\nCase 3\n: Distant group means with high variation within the groups\n\nCase 4\n: Distant group means with low variation within the groups\n\n\n```{r}\nDesign <- rbindlist(list(\n    Case1 = data.table(\n        Group = paste(\"G\", 1:2, sep = \"\"),\n        Mean = c(6, 8),\n        SD = c(6, 8)\n    ),\n    Case2 = data.table(\n        Group = paste(\"G\", 1:2, sep = \"\"),\n        Mean = c(6, 8),\n        SD = c(3, 4)\n    ),\n    Case3 = data.table(\n        Group = paste(\"G\", 1:2, sep = \"\"),\n        Mean = c(8, 20),\n        SD = c(8, 20)\n    ),\n    Case4 = data.table(\n        Group = paste(\"G\", 1:2, sep = \"\"),\n        Mean = c(8, 20),\n        SD = c(4, 10)\n    )\n), idcol = \"Cases\")\n```\n\n## Fitting ANOVA model for each cases\n```{r}\nModel <- Design[, map2_df(Mean, SD, ~list(data.table(\n    Response = rnorm(25, .x, .y)\n))), by = .(Cases, Group)] %>% \n.[, .(Data = list(.SD)), by = Cases] %>% \n.[, Fit := map(Data, ~lm(Response ~ Group, data = .x))]\n```\n\n## Prepare data for plotting\n\n```{r}\nplot_data <- Model[, map_df(Fit, broom::augment), by = Cases]\n```\n\n\n```{r}\nggplot(plot_data, aes(Response, Group)) +\n    geom_point(aes(fill = Group),\n        position = position_jitter(height = 0.1),\n        shape = 21, size = 2, stroke = 0.25, alpha = 0.25\n    ) +\n    stat_summary(\n        fun.data = mean_se, geom = \"errorbar\", aes(color = Group),\n        width = 0.2, size = 0.75\n    ) +\n    stat_summary(\n        fun = mean, geom = \"point\", aes(color = Group),\n        size = 2, shape = 21, fill = \"whitesmoke\", stroke = 0.75\n    ) +\n    facet_wrap(facets = vars(Cases), scales = \"free_x\") +\n    ggridges::geom_density_ridges(\n        aes(color = Group),\n        fill = NA,\n        panel_scaling = FALSE\n    ) +\n    scale_color_brewer(palette = \"Set1\") +\n    scale_fill_brewer(palette = \"Set1\")\n```\n\n```{r}\nggplot(plot_data) +\n    geom_text(\n        data = Design, aes(\n            label = glue::glue(\"Mean: {Mean}, SD: {SD}\"),\n            color = Group\n        ),\n        x = Inf, y = Inf,\n        hjust = 1.1,\n        vjust = rep(c(1.5, 3.5), 4),\n        show.legend = FALSE\n    ) +\n    geom_point(\n        aes(Response, Group, color = Group),\n        position = position_jitter(height = 0.1),\n        shape = 21, stroke = 0.5,\n        alpha = 0.5\n    ) +\n    ggridges::geom_density_ridges(\n        aes(Response, Group, color = Group),\n        scale = 0.9,\n        fill = NA\n    ) +\n    ggridges::geom_density_ridges(\n        aes(.fitted, Group, color = Group), \n        linetype = \"dashed\",\n        scale = 0.9,\n        fill = NA\n    ) +\n    facet_wrap(\n        facets = vars(Cases),\n        dir = \"v\",\n        scales = \"free_x\"\n    ) +\n    scale_color_brewer(palette = \"Set1\") +\n    theme(\n        legend.position = \"bottom\"\n    ) +\n    labs(\n        x = \"Response\",\n        y = \"Density\",\n        linetype = NULL\n    )\n```\n\n## Discussion\n\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"output-file":"index.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.335","fontsize":"1.2em","linestretch":1.75,"theme":{"light":["default","../../../light.scss","../../../styles.scss"],"dark":["default","../../../dark.scss","../../../styles.scss"]},"title-block-banner":false,"title":"How ANOVA analyze the variance","slug":"how-anova-analyze-the-variance","author":"therimalaya","date":"2021-03-29","tags":["Statistics","ANOVA"]},"extensions":{"book":{"multiFile":true}}}}}